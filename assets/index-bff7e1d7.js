import{iA as R,iB as z,d as P,c as N,r as y,w as x,as as S,av as O,aw as n,aB as e,aC as m,az as _,aJ as q,df as C,aD as l,h as $,aK as E,at as K,ax as d,aW as M,ag as Q,ae as W,iQ as Y,aY as G,ao as H,bk as X}from"./index-d34e0519.js";import{_ as Z,a as ee,b as v,s as te}from"./index.vue_vue_type_script_setup_true_lang-21655c41.js";import{d as B}from"./time-0f38da99.js";import{C as ae}from"./difference-a6ec943c.js";import{s as k}from"./supplier-9105ad61.js";import{_ as oe}from"./ListTable.vue_vue_type_script_setup_true_lang-6f3668cb.js";import{_ as U,a as I}from"./DescriptionsItem-f5b97799.js";import{N as D}from"./text-92e19e0a.js";import{N as J}from"./Space-b4b83a0d.js";import{_ as ne}from"./Tag-1e615c64.js";import{_ as se,a as re}from"./Tabs-b311b687.js";import"./SearchableSelect.vue_vue_type_script_setup_true_lang-b25c0716.js";import"./Select-ed1484d1.js";import"./use-merged-state-38e48ef5.js";import"./Suffix-82265be2.js";import"./use-compitable-c9ad10e0.js";import"./cssr-bdc68017.js";import"./Popover-7a5e5188.js";import"./get-0596a638.js";import"./format-length-c9d165c6.js";import"./next-frame-once-7035a838.js";import"./DatePicker-bc839373.js";import"./Dropdown-07d5487b.js";import"./DataTable-5dd479e1.js";import"./Checkbox-5d323e84.js";import"./Input-5a80c108.js";import"./InputNumber-f672dc0a.js";import"./Add-b172a4da.js";import"./Switch-ad10093b.js";import"./Popconfirm-ab3b5a82.js";import"./refresh-8a8ec83d.js";import"./use-loading-f04b65e1.js";import"./vuedraggable.umd-510056e9.js";const A={...R},le=[...z],pe=P({__name:"ProductLotDetail",props:{visible:{type:Boolean},productLot:{}},emits:["update:visible","updateSucceed"],setup(c,{emit:f}){const o=c,g=N({get(){return o.visible},set(p){f("update:visible",p)}}),u=y(o.productLot);x(()=>o.productLot,p=>{p&&(u.value=JSON.parse(JSON.stringify(o.productLot)))});const b=N(()=>{var p,w;return C((p=u.value)==null?void 0:p.purchasingDate)?B((w=u.value)==null?void 0:w.purchasingDate):""});return(p,w)=>{const a=U,t=I,i=q;return S(),O(i,{show:g.value,"onUpdate:show":w[0]||(w[0]=r=>g.value=r),preset:"card",title:p.$t("warehouse.productLot.tittle"),class:"w-600px"},{default:n(()=>[e(t,{columns:2,"label-placement":"left",class:"text-center",bordered:""},{default:n(()=>[e(a,{span:2,label:p.$t("warehouse.property.name")},{default:n(()=>{var r;return[m(_((r=u.value.product)==null?void 0:r.name),1)]}),_:1},8,["label"]),e(a,{span:2,label:p.$t("warehouse.productLot.number")},{default:n(()=>[m(_(u.value.lotNo),1)]),_:1},8,["label"]),e(a,{span:2,label:p.$t("warehouse.property.count")},{default:n(()=>[m(_(u.value.count),1)]),_:1},8,["label"]),e(a,{span:2,label:p.$t("warehouse.productLot.purchasingDate")},{default:n(()=>[m(_(b.value),1)]),_:1},8,["label"]),e(a,{span:2,label:p.$t("warehouse.productLot.purchasingPrice")},{default:n(()=>{var r;return[m(_((r=u.value)==null?void 0:r.purchasingPrice),1)]}),_:1},8,["label"]),e(a,{span:2,label:p.$t("warehouse.property.paid")},{default:n(()=>{var r;return[m(_((r=u.value)==null?void 0:r.paid),1)]}),_:1},8,["label"]),e(a,{span:2,label:p.$t("warehouse.property.storageAddress")},{default:n(()=>{var r;return[m(_((r=u.value)==null?void 0:r.storageAddress),1)]}),_:1},8,["label"])]),_:1})]),_:1},8,["show","title"])}}});function ue(){return[{key:"name",title:l("warehouse.property.name"),align:"center",render:c=>$(D,{},{default:()=>{var f;return(f=c.product)==null?void 0:f.name}})},{key:"lotNo",title:l("warehouse.productLot.number"),align:"center"},{key:"count",title:l("warehouse.property.count"),align:"center"},{key:"purchasingPrice",title:l("warehouse.productLot.purchasingPrice"),align:"center",render:c=>$(D,{},{default:()=>`€${c.purchasingPrice}`})},{key:"paid",title:l("warehouse.property.paid"),align:"center",render:c=>$(D,{},{default:()=>`€${c.paid}`})},{key:"purchasingDate",title:l("warehouse.productLot.purchasingDate"),align:"center"},{key:"storageAddress",title:l("warehouse.property.storageAddress"),align:"center"}]}function ie(c){return typeof c=="function"||Object.prototype.toString.call(c)==="[object Object]"&&!Y(c)}const de=P({__name:"index",props:{productLots:{}},setup(c){const f=c,o=y(f.productLots||[]);x(()=>f.productLots,a=>{a&&(o.value=JSON.parse(JSON.stringify(f.productLots)))});function g(){return[{key:"actions",title:l("warehouse.property.operation"),align:"center",render:a=>{let t;return e(J,{justify:"center"},{default:()=>[e(W,{size:"small",onClick:()=>w(a.id)},ie(t=l("warehouse.common.showDetail"))?t:{default:()=>[t]})]})}}]}const u=y({}),{bool:b,setTrue:p}=E();function w(a){const t=o.value.find(i=>i.id===a);t&&(u.value=t,p())}return(a,t)=>(S(),K(Q,null,[e(oe,{ref:"listTable","columns-fn":d(ue),"action-columns-fn":g,data:o.value,"init-load":!1,"disable-header":!0},null,8,["columns-fn","data"]),e(pe,{visible:d(b),"onUpdate:visible":t[0]||(t[0]=i=>M(b)?b.value=i:null),"product-lot":u.value},null,8,["visible","product-lot"])],64))}}),Ke=P({__name:"index",setup(c){const f=G(),o=y({}),g=N(()=>{var a,t;return C((a=o.value)==null?void 0:a.createdAt)?B((t=o.value)==null?void 0:t.createdAt):""}),u=new ae;function b(a,t){const i=o.value[a];te(o.value,a,t),u.updateProp({key:a,oldValue:i,newValue:t,propOptions:le})}async function p(){var t,i;const{error:a}=await k.update(o.value.id,u.generateChangedRecord());a?(t=window.$message)==null||t.error(`${l("warehouse.common.operateFailed")} ${a.msg}`):((i=window.$message)==null||i.success(l("warehouse.common.editSuccess")),setTimeout(()=>{H().reloadPage()},500))}async function w(){var i;const a=(i=f.query)==null?void 0:i.id,{data:t}=await k.get(a);t&&(o.value=JSON.parse(JSON.stringify(t)))}return w(),(a,t)=>{const i=J,r=U,L=ne,j=I,T=se,V=re,F=X;return S(),O(F,{bordered:!1,class:"h-full rounded-16px shadow-sm"},{default:n(()=>[e(i,{class:"pb-12px",justify:"space-between"},{default:n(()=>[e(Z,{"last-path":"warehouse_supplier"}),e(ee,{class:"max-w-500px",data:d(u).changedData.value,onPositiveClick:p},null,8,["data"])]),_:1}),e(j,{columns:6,"label-placement":"left",class:"text-center",bordered:""},{default:n(()=>[e(r,{span:2,label:d(l)("warehouse.property.name")},{default:n(()=>{var s;return[m(_((s=o.value)==null?void 0:s.name),1)]}),_:1},8,["label"]),e(r,{span:2,label:d(l)("warehouse.property.phone")},{default:n(()=>{var s;return[e(v,{"edit-component":"NInput",data:(s=o.value)==null?void 0:s.phone,"onUpdate:data":t[0]||(t[0]=h=>b("phone",h))},null,8,["data"])]}),_:1},8,["label"]),e(r,{span:2,label:d(l)("warehouse.property.address")},{default:n(()=>{var s;return[e(v,{data:(s=o.value)==null?void 0:s.address,"onUpdate:data":t[1]||(t[1]=h=>b("address",h))},null,8,["data"])]}),_:1},8,["label"]),e(r,{span:2,label:d(l)("warehouse.property.totalPaid")+"/"+d(l)("warehouse.property.totalPrice")},{default:n(()=>[e(L,{type:"primary"},{default:n(()=>{var s;return[m("€"+_((s=o.value)==null?void 0:s.totalPaid),1)]}),_:1}),m(" / "),e(L,{type:"success"},{default:n(()=>{var s;return[m("€"+_((s=o.value)==null?void 0:s.totalPrice),1)]}),_:1})]),_:1},8,["label"]),e(r,{span:2,label:d(l)("warehouse.property.status")},{default:n(()=>{var s;return[e(L,{type:d(A)[((s=o.value)==null?void 0:s.status)||"1"].type},{default:n(()=>{var h;return[m(_(d(A)[((h=o.value)==null?void 0:h.status)||"1"].label),1)]}),_:1},8,["type"])]}),_:1},8,["label"]),e(r,{span:2,label:d(l)("warehouse.property.createdAt")},{default:n(()=>[m(_(g.value),1)]),_:1},8,["label"]),e(r,{span:6,label:d(l)("warehouse.property.invoiceInfo"),"content-style":{textAlign:"left",whiteSpace:"pre-wrap"}},{default:n(()=>{var s;return[e(v,{"edit-component":"NInput","edit-component-props":{type:"textarea"},data:(s=o.value)==null?void 0:s.invoiceInfo,"onUpdate:data":t[2]||(t[2]=h=>b("invoiceInfo",h))},null,8,["data"])]}),_:1},8,["label"]),e(r,{span:6,label:d(l)("warehouse.property.comment")},{default:n(()=>{var s;return[e(v,{data:(s=o.value)==null?void 0:s.comment,"onUpdate:data":t[3]||(t[3]=h=>b("comment",h))},null,8,["data"])]}),_:1},8,["label"])]),_:1}),e(V,{type:"line",animated:""},{default:n(()=>[e(T,{name:"lot",tab:d(l)("warehouse.productLot.tittle")},{default:n(()=>[e(de,{"product-lots":o.value.productLots||[]},null,8,["product-lots"])]),_:1},8,["tab"])]),_:1})]),_:1})}}});export{Ke as default};
