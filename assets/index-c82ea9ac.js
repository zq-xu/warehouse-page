import{d as h,aY as C,r as S,c as D,as as I,av as U,aw as n,aB as t,ax as f,aC as u,az as m,ao as O,bk as q,df as B}from"./index-abdd351b.js";import{_ as k,a as J,b as i,s as R}from"./index.vue_vue_type_script_setup_true_lang-2bcc5ee5.js";import{d as T}from"./time-09cbfc6e.js";import{C as V}from"./difference-ee82a1a2.js";import{c as b}from"./customer-4da3e098.js";import{_ as j}from"./index.vue_vue_type_script_setup_true_lang-89206621.js";import{N as z}from"./Space-b1d09008.js";import{_ as F,a as L}from"./DescriptionsItem-a0602fcf.js";import{_ as Y}from"./Tag-d7c56c8d.js";import{_ as E,a as G}from"./Tabs-ffc8ba4b.js";import"./SearchableSelect.vue_vue_type_script_setup_true_lang-7a5fcd6a.js";import"./Select-b44a3ca0.js";import"./use-merged-state-819b618f.js";import"./Suffix-9dcbc97d.js";import"./use-compitable-92c58416.js";import"./cssr-b0f85bf5.js";import"./Popover-4ab62dc2.js";import"./get-adbc5cb4.js";import"./format-length-c9d165c6.js";import"./next-frame-once-7035a838.js";import"./DatePicker-7fdab619.js";import"./Dropdown-7c020671.js";import"./DataTable-f31b3f0d.js";import"./Checkbox-63cc49b7.js";import"./Input-fea9007e.js";import"./InputNumber-7e5cbf6a.js";import"./Add-d1eb1a2a.js";import"./Switch-1eb24d46.js";import"./text-b77baa86.js";import"./Popconfirm-09513e79.js";import"./ListTable.vue_vue_type_script_setup_true_lang-2a5e3e35.js";import"./vuedraggable.umd-106a2257.js";import"./refresh-c3c69e70.js";import"./use-loading-16047a9b.js";const v={1:{label:"正常",type:"success"},2:{label:"异常",type:"error"},3:{label:"已删除",type:"default"}},H=[{label:"名称",value:"name"},{label:"联系方式",value:"phone"},{label:"常用地址",value:"address"},{label:"创建时间",value:"createdAt"},{label:"更新时间",value:"updatedAt"},{label:"备注信息",value:"comment"}],Da=h({__name:"index",setup(K){const g=C(),o=S({}),y=D(()=>{var s,e;return B((s=o.value)==null?void 0:s.createdAt)?T((e=o.value)==null?void 0:e.createdAt):""}),c=new V;function d(s,e){const l=o.value[s];R(o.value,s,e),c.updateProp({key:s,oldValue:l,newValue:e,propOptions:H})}async function w(){var e,l;const{error:s}=await b.update(o.value.id,c.generateChangedRecord());s?(e=window.$message)==null||e.error(`操作失败! ${s.msg}`):((l=window.$message)==null||l.success("修改成功!"),setTimeout(()=>{O().reloadPage()},500))}async function x(){var l;const s=(l=g.query)==null?void 0:l.id,{data:e}=await b.get(s);o.value=JSON.parse(JSON.stringify(e))}return x(),(s,e)=>{const l=z,r=F,_=Y,N=L,P=E,A=G,$=q;return I(),U($,{bordered:!1,class:"h-full rounded-16px shadow-sm"},{default:n(()=>[t(l,{class:"pb-12px",justify:"space-between"},{default:n(()=>[t(k,{"last-path":"warehouse_customer"}),t(J,{class:"max-w-500px",data:f(c).changedData.value,onPositiveClick:w},null,8,["data"])]),_:1}),t(N,{columns:6,"label-placement":"left",class:"text-center",bordered:""},{default:n(()=>[t(r,{span:2,label:"客户名称"},{default:n(()=>{var a;return[u(m((a=o.value)==null?void 0:a.name),1)]}),_:1}),t(r,{span:2,label:"联系方式"},{default:n(()=>{var a;return[t(i,{"edit-component":"NInput",data:(a=o.value)==null?void 0:a.phone,"onUpdate:data":e[0]||(e[0]=p=>d("phone",p))},null,8,["data"])]}),_:1}),t(r,{span:2,label:"常用地址"},{default:n(()=>{var a;return[t(i,{data:(a=o.value)==null?void 0:a.address,"onUpdate:data":e[1]||(e[1]=p=>d("address",p))},null,8,["data"])]}),_:1}),t(r,{span:2,label:"支付/总额"},{default:n(()=>[t(_,{type:"success"},{default:n(()=>{var a;return[u("€"+m((a=o.value)==null?void 0:a.totalPaid),1)]}),_:1}),u(" / "),t(_,{type:"primary"},{default:n(()=>{var a;return[u("€"+m((a=o.value)==null?void 0:a.totalPrice),1)]}),_:1})]),_:1}),t(r,{span:2,label:"客户状态"},{default:n(()=>{var a;return[t(_,{type:f(v)[((a=o.value)==null?void 0:a.status)||"1"].type},{default:n(()=>{var p;return[u(m(f(v)[((p=o.value)==null?void 0:p.status)||"1"].label),1)]}),_:1},8,["type"])]}),_:1}),t(r,{span:2,label:"创建时间"},{default:n(()=>[u(m(y.value),1)]),_:1}),t(r,{span:6,label:"发票信息","content-style":{textAlign:"left",whiteSpace:"pre-wrap"}},{default:n(()=>{var a;return[t(i,{"edit-component":"NInput","edit-component-props":{type:"textarea"},data:(a=o.value)==null?void 0:a.invoiceInfo,"onUpdate:data":e[2]||(e[2]=p=>d("invoiceInfo",p))},null,8,["data"])]}),_:1}),t(r,{span:6,label:"备注信息"},{default:n(()=>{var a;return[t(i,{data:(a=o.value)==null?void 0:a.comment,"onUpdate:data":e[3]||(e[3]=p=>d("comment",p))},null,8,["data"])]}),_:1})]),_:1}),t(A,{type:"line",animated:""},{default:n(()=>[t(P,{name:"lot",tab:"订单信息"},{default:n(()=>{var a;return[t(j,{"query-map":{customerId:(a=o.value)==null?void 0:a.id}},null,8,["query-map"])]}),_:1})]),_:1})]),_:1})}}});export{Da as default};
