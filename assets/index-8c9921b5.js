import{_ as ie}from"./export-b39f3924.js";import{_ as q}from"./round-plus-88128d85.js";import{c as V,u as j,a as ue,_ as ce}from"./round-warehouse-0179d178.js";import{d as R,c as B,r as C,b8 as W,aD as o,as as S,av as M,aw as a,aB as e,ax as s,aC as D,az as A,ae as E,aJ as J,jd as F,h as z,bE as pe,y as de,at as me,aK as N,aW as U,j4 as _e,aZ as fe,iV as L,bj as ge,bk as be,iQ as ye}from"./index-82878933.js";import{_ as we}from"./ListTable.vue_vue_type_script_setup_true_lang-158742c1.js";import{_ as he}from"./SearchableSelect.vue_vue_type_script_setup_true_lang-120c33c2.js";import{c as I,u as P,a as K}from"./rule-34c9079a.js";import{_ as Q}from"./Input-73537fce.js";import{_ as Z}from"./FormItemGridItem-0a2884f7.js";import{_ as ve}from"./InputNumber-d988ee38.js";import{a as G}from"./Grid-32cf7ff4.js";import{N as T}from"./Space-5ce7b0d3.js";import{N as H}from"./Image-f1583a24.js";import{_ as xe,a as Ce}from"./DescriptionsItem-ae41fcf7.js";import{_ as ke}from"./DataTable-380fd57e.js";import{_ as X}from"./DrawerContent-58794e90.js";import{_ as Y}from"./Drawer-c3c5e12c.js";import{N as O}from"./text-1d62828f.js";import{_ as $e}from"./Tag-44f4bb3b.js";import"./Add-b56c8fee.js";import"./format-length-c9d165c6.js";import"./use-merged-state-73225c5f.js";import"./refresh-26d8b195.js";import"./use-loading-499c0e90.js";import"./vuedraggable.umd-dc8b72a9.js";import"./Checkbox-60e346ec.js";import"./Popover-77a1abb2.js";import"./Suffix-9de0baa4.js";import"./get-f3cd441e.js";import"./cssr-4b5a1daa.js";import"./use-compitable-88d2e5e4.js";import"./next-frame-once-7035a838.js";import"./Select-8c691358.js";import"./utils-9551f71a.js";import"./Dropdown-b655dc06.js";const De=R({__name:"index",props:{visible:{type:Boolean}},emits:["update:visible","succeed"],setup(r,{emit:i}){const m=r,p=B({get(){return m.visible},set(c){i("update:visible",c)}}),g=()=>{p.value=!1},_=C(),n=C(0);function y(c){n.value=c.fileList.length}function w(){var c;g(),i("succeed"),(c=_.value)==null||c.clear(),n.value=0}const h=C(),t=W({}),d={name:I(o("warehouse.property.namePlaceholder")),categoryId:I(o("warehouse.product.categoryPlaceholder")),price:P,storageAddress:P};function u(){t.price=t.price?t.price:0,t.storageAddress=t.storageAddress?t.storageAddress:""}async function f(){var c,l;await((c=h.value)==null?void 0:c.validate()),u(),n.value?(l=_.value)==null||l.submit():j(F,{onFinish:w},{organizeData:k})}function v(c){c.onFinish=w,j(F,c,{organizeData:k})}function k(c){var b;const l=new FormData;return(b=c.file)!=null&&b.file&&l.append("image",c.file.file),Object.keys(t).forEach($=>{l.append($,t[$])}),l}return(c,l)=>{const b=Q,$=Z,ee=ue,te=he,oe=ve,ae=G,ne=K,se=E,re=T,le=J;return S(),M(le,{show:p.value,"onUpdate:show":l[4]||(l[4]=x=>p.value=x),preset:"card",title:s(o)("warehouse.common.add"),class:"w-700px"},{default:a(()=>[e(ne,{ref_key:"formRef",ref:h,class:"w-80% m-auto","label-placement":"left","label-width":150,model:t,rules:d},{default:a(()=>[e(ae,{cols:12,"x-gap":18},{default:a(()=>[e($,{span:12,label:s(o)("warehouse.property.name"),path:"name"},{default:a(()=>[e(b,{value:t.name,"onUpdate:value":l[0]||(l[0]=x=>t.name=x)},null,8,["value"])]),_:1},8,["label"]),e($,{span:12,label:s(o)("warehouse.product.image"),path:"image"},{default:a(()=>[e(ee,{ref_key:"upload",ref:_,"custom-request":v,"list-type":"image-card",max:1,"default-upload":!1,onChange:y},null,512)]),_:1},8,["label"]),e($,{span:12,label:s(o)("warehouse.product.category"),path:"categoryId"},{default:a(()=>[e(te,{value:t.categoryId,"list-fn":s(V).listBaseInfo,"onUpdate:value":l[1]||(l[1]=x=>t.categoryId=x==null?void 0:x.value)},null,8,["value","list-fn"])]),_:1},8,["label"]),e($,{span:12,label:s(o)("warehouse.property.price")+"/€",path:"price"},{default:a(()=>[e(oe,{value:t.price,"onUpdate:value":l[2]||(l[2]=x=>t.price=x),min:0},null,8,["value"])]),_:1},8,["label"]),e($,{span:12,label:s(o)("warehouse.property.storageAddress"),path:"storageAddress"},{default:a(()=>[e(b,{value:t.storageAddress,"onUpdate:value":l[3]||(l[3]=x=>t.storageAddress=x)},null,8,["value"])]),_:1},8,["label"])]),_:1})]),_:1},8,["model"]),e(re,{class:"w-full pt-16px",size:12,justify:"end"},{default:a(()=>[e(se,{class:"w-72px",type:"primary",onClick:f},{default:a(()=>[D(A(s(o)("warehouse.common.confirm")),1)]),_:1})]),_:1})]),_:1},8,["show","title"])}}}),Ae=[{key:"thumbnail",title:o("warehouse.category.productImage"),align:"center",width:"200px",render:r=>z(H,{src:r.thumbnail||""})},{key:"name",title:o("warehouse.category.productName"),align:"center"},{key:"totalCount",title:o("warehouse.category.productCount"),align:"center"}],Ee=R({name:"CategoryDetailDrawer",__name:"index",props:{visible:{type:Boolean},id:{}},emits:["update:visible","succeed"],setup(r,{emit:i}){const m=r,p=B({get(){return m.visible},set(n){i("update:visible",n)}}),g=C({});async function _(){const{data:n}=await V.get(m.id);n&&(g.value=n)}return(n,y)=>{const w=xe,h=Ce,t=ke,d=X,u=Y;return S(),M(u,{show:p.value,"display-directive":"show","default-width":"900",resizable:"",onMaskClick:y[0]||(y[0]=f=>p.value=!1),onAfterEnter:_},{default:a(()=>[e(d,{title:n.$t("warehouse.category.detailTittle"),"native-scrollbar":!1},{default:a(()=>{var f;return[e(h,{columns:4,"label-placement":"left",class:"text-center mb-12px",bordered:""},{default:a(()=>[e(w,{span:2,label:n.$t("warehouse.property.name")},{default:a(()=>{var v;return[D(A((v=g.value)==null?void 0:v.name),1)]}),_:1},8,["label"]),e(w,{span:2,label:n.$t("warehouse.category.productCount")},{default:a(()=>{var v;return[D(A((v=g.value)==null?void 0:v.productCount),1)]}),_:1},8,["label"])]),_:1}),e(t,{remote:"",columns:s(Ae),data:((f=g.value)==null?void 0:f.products)??[]},null,8,["columns","data"])]}),_:1},8,["title"])]),_:1},8,["show"])}}}),Re=R({__name:"index",props:{visible:{type:Boolean}},emits:["update:visible","succeed"],setup(r,{emit:i}){const m=r,p=B({get(){return m.visible},set(h){i("update:visible",h)}}),g=()=>{p.value=!1},_=C(),n=W({}),y={name:I("请输入商品分类名称")};async function w(){var t,d;await((t=_.value)==null?void 0:t.validate());const{error:h}=await V.create(n);h||((d=window.$message)==null||d.success(o("warehouse.common.addSuccess")),g(),i("succeed"))}return(h,t)=>{const d=Q,u=Z,f=G,v=K,k=E,c=T,l=J;return S(),M(l,{show:p.value,"onUpdate:show":t[1]||(t[1]=b=>p.value=b),preset:"card",title:s(o)("warehouse.common.add")+" "+s(o)("warehouse.category.tittle"),class:"w-700px"},{default:a(()=>[e(v,{ref_key:"formRef",ref:_,class:"w-80% m-auto","label-placement":"left","label-width":150,model:n,rules:y},{default:a(()=>[e(f,{cols:12,"x-gap":18},{default:a(()=>[e(u,{span:12,label:s(o)("warehouse.category.tittle"),path:"name"},{default:a(()=>[e(d,{value:n.name,"onUpdate:value":t[0]||(t[0]=b=>n.name=b)},null,8,["value"])]),_:1},8,["label"])]),_:1})]),_:1},8,["model"]),e(c,{class:"w-full pt-16px",size:12,justify:"end"},{default:a(()=>[e(k,{class:"w-72px",type:"primary",onClick:w},{default:a(()=>[D(A(s(o)("warehouse.common.confirm")),1)]),_:1})]),_:1})]),_:1},8,["show","title"])}}});function Se(r){const i=[];return r.forEach(m=>{i.push({id:m.id,name:m.name,value:m.productCount})}),i}function ze(r){return{tooltip:{trigger:"item"},legend:{bottom:"1%",left:"center",itemStyle:{borderWidth:0}},series:[{name:`${o("warehouse.category.tittle")} ${o("warehouse.property.count")}`,type:"pie",radius:["45%","75%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:1},label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:"12"}},labelLine:{show:!1},data:Se(r.items)}]}}const Me=R({name:"CategoryEchart",__name:"CategoryEchart",emits:["click"],setup(r,{expose:i,emit:m}){const p=C({}),{domRef:g}=pe(p,n=>{n.on("click",y=>{m("click",y.data)})});async function _(){const{data:n}=await V.list("",{pageSize:"1000"});n&&(p.value=ze(n))}return de(()=>{_()}),i({loadEchartData:_}),(n,y)=>(S(),me("div",{ref_key:"pieRef",ref:g,class:"w-full h-500px"},null,512))}}),Ne=R({name:"CategoryDashboardDrawer",__name:"index",props:{visible:{type:Boolean}},emits:["update:visible","succeed"],setup(r,{emit:i}){const m=r,p=B({get(){return m.visible},set(u){i("update:visible",u)}}),g=C(),_=()=>{var u;return(u=g.value)==null?void 0:u.loadEchartData()},{bool:n,setTrue:y}=N(),{bool:w,setTrue:h}=N(),t=C("");function d(u){t.value=u.id,y()}return(u,f)=>{const v=q,k=E,c=X,l=Y;return S(),M(l,{show:p.value,"display-directive":"show","default-width":"900",resizable:"",onMaskClick:f[2]||(f[2]=b=>p.value=!1)},{default:a(()=>[e(c,{title:u.$t("warehouse.category.tittle"),"native-scrollbar":!1},{footer:a(()=>[e(k,{size:"small",type:"primary",onClick:s(h)},{default:a(()=>[e(v,{class:"mr-4px text-20px"}),D(" "+A(u.$t("warehouse.common.add")),1)]),_:1},8,["onClick"])]),default:a(()=>[e(Me,{ref_key:"categoryEchart",ref:g,onClick:d},null,512)]),_:1},8,["title"]),e(Ee,{id:t.value,visible:s(n),"onUpdate:visible":f[0]||(f[0]=b=>U(n)?n.value=b:null)},null,8,["id","visible"]),e(Re,{visible:s(w),"onUpdate:visible":f[1]||(f[1]=b=>U(w)?w.value=b:null),onSucceed:_},null,8,["visible"])]),_:1},8,["show"])}}});function Ue(){return[{key:"images",title:o("warehouse.product.image"),align:"center",width:"200px",render:r=>z(H,{src:r.thumbnail||""})},{key:"name",title:o("warehouse.property.name"),align:"center"},{key:"category",title:o("warehouse.product.category"),align:"center",render:r=>z(O,{},{default:()=>{var i;return`${(i=r.category)==null?void 0:i.name}`}})},{key:"totalCount",title:o("warehouse.property.count"),align:"center"},{key:"price",title:o("warehouse.property.price"),align:"center",render:r=>z(O,{},{default:()=>`€${r.price}`})},{key:"storageAddress",title:o("warehouse.property.storageAddress"),align:"center"},{key:"status",title:o("warehouse.property.status"),align:"center",render:r=>{const i=_e[r.status||"1"];return z($e,{type:i.type},{default:()=>i.label})}}]}function Ve(r){return typeof r=="function"||Object.prototype.toString.call(r)==="[object Object]"&&!ye(r)}const bt=R({__name:"index",setup(r){const{bool:i,setTrue:m}=N(),{bool:p,setTrue:g}=N(),_=C(),n=()=>L.exportProductExcel(),y=()=>{var d;return(d=_.value)==null?void 0:d.loadTableData()};function w(){return[{key:"actions",title:o("warehouse.property.operation"),align:"center",render:d=>{let u;return e(T,{justify:"center"},{default:()=>[e(E,{size:"small",onClick:()=>t(d.id)},Ve(u=o("warehouse.common.showDetail"))?u:{default:()=>[u]})]})}}]}const{routerPush:h}=fe();function t(d){h({name:ge("warehouse_product-detail"),query:{id:d}})}return(d,u)=>{const f=ce,v=q,k=ie,c=be;return S(),M(c,{bordered:!1,class:"h-full rounded-16px shadow-sm"},{default:a(()=>[e(we,{ref_key:"listTable",ref:_,"columns-fn":s(Ue),"action-columns-fn":w,"load-data":s(L).list},{default:a(()=>[e(s(E),{size:"small",type:"primary",onClick:s(g)},{default:a(()=>[e(f,{class:"mr-4px text-20px"}),D(" "+A(s(o)("warehouse.category.tittle")),1)]),_:1},8,["onClick"]),e(s(E),{size:"small",type:"primary",onClick:s(m)},{default:a(()=>[e(v,{class:"mr-4px text-20px"}),D(" "+A(s(o)("warehouse.common.add")),1)]),_:1},8,["onClick"]),e(s(E),{size:"small",type:"success",onClick:n},{default:a(()=>[e(k,{class:"mr-4px text-20px"}),D(" "+A(s(o)("warehouse.common.exportExcel")),1)]),_:1})]),_:1},8,["columns-fn","load-data"]),e(De,{visible:s(i),"onUpdate:visible":u[0]||(u[0]=l=>U(i)?i.value=l:null),onSucceed:y},null,8,["visible"]),e(Ne,{visible:s(p),"onUpdate:visible":u[1]||(u[1]=l=>U(p)?p.value=l:null)},null,8,["visible"])]),_:1})}}});export{bt as default};
