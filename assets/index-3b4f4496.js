import{_ as re}from"./export-d16a5a7e.js";import{_ as q}from"./round-plus-17f4e9b6.js";import{c as S,u as T,a as ie,b as ue,_ as ce}from"./round-warehouse-fb9ec436.js";import{d as E,c as U,r as k,b8 as O,as as R,av as z,aw as n,aB as e,ax as b,aC as x,ae as D,aJ as W,j8 as V,h as A,az as F,bE as pe,y as _e,at as de,aK as B,aW as M,aZ as me,iS as L,bj as fe,bk as be}from"./index-226c16fc.js";import{_ as ge}from"./ListTable.vue_vue_type_script_setup_true_lang-923ead03.js";import{_ as ve}from"./SearchableSelect.vue_vue_type_script_setup_true_lang-a2b54539.js";import{c as I,u as j,a as J}from"./rule-0205d26b.js";import{_ as K}from"./Input-4f09af90.js";import{_ as Z}from"./FormItemGridItem-4cb5c7bc.js";import{_ as ye}from"./InputNumber-f2ab9a79.js";import{a as G}from"./Grid-f2d45d29.js";import{N}from"./Space-29d90a90.js";import{N as H}from"./Image-31a33b85.js";import{_ as we,a as he}from"./DescriptionsItem-cc739a29.js";import{_ as xe}from"./DataTable-f4da4ff8.js";import{_ as Q}from"./DrawerContent-0baa19a2.js";import{_ as X}from"./Drawer-adc840ed.js";import{N as P}from"./text-7f34c8da.js";import{_ as ke}from"./Tag-58259951.js";import"./Add-5e0ddf2e.js";import"./format-length-c9d165c6.js";import"./use-merged-state-f061fd31.js";import"./vuedraggable.umd-abc431c6.js";import"./refresh-fbdfae5c.js";import"./Checkbox-c63f0c7a.js";import"./Popover-9915398a.js";import"./Suffix-ed6a86a3.js";import"./get-54cbc8e8.js";import"./cssr-6b3a0ba4.js";import"./use-compitable-621a686c.js";import"./next-frame-once-7035a838.js";import"./use-loading-ec39d282.js";import"./Select-6d9d23aa.js";import"./utils-20cf9c66.js";import"./Dropdown-84ed0a2b.js";const Ce=E({__name:"index",props:{visible:{type:Boolean}},emits:["update:visible","succeed"],setup(l,{emit:s}){const p=l,i=U({get(){return p.visible},set(r){s("update:visible",r)}}),m=()=>{i.value=!1},_=k(),o=k(0);function g(r){o.value=r.fileList.length}function v(){var r;m(),s("succeed"),(r=_.value)==null||r.clear(),o.value=0}const y=k(),t=O({}),u={name:I("请输入商品名称"),categoryId:I("请输入商品分类"),price:j,storageAddress:j};function c(){t.price=t.price?t.price:0,t.storageAddress=t.storageAddress?t.storageAddress:""}async function d(){var r,a;await((r=y.value)==null?void 0:r.validate()),c(),o.value?(a=_.value)==null||a.submit():T(V,{onFinish:v},{organizeData:C})}function w(r){r.onFinish=v,T(V,r,{organizeData:C})}function C(r){var f;const a=new FormData;return(f=r.file)!=null&&f.file&&a.append("image",r.file.file),Object.keys(t).forEach($=>{a.append($,t[$])}),a}return(r,a)=>{const f=K,$=Z,Y=ie,ee=ve,te=ye,ne=G,oe=J,ae=D,se=N,le=W;return R(),z(le,{show:i.value,"onUpdate:show":a[4]||(a[4]=h=>i.value=h),preset:"card",title:"新增商品",class:"w-700px"},{default:n(()=>[e(oe,{ref_key:"formRef",ref:y,class:"w-80% m-auto","label-placement":"left","label-width":150,model:t,rules:u},{default:n(()=>[e(ne,{cols:12,"x-gap":18},{default:n(()=>[e($,{span:12,label:"名称",path:"name"},{default:n(()=>[e(f,{value:t.name,"onUpdate:value":a[0]||(a[0]=h=>t.name=h)},null,8,["value"])]),_:1}),e($,{span:12,label:"图片",path:"image"},{default:n(()=>[e(Y,{ref_key:"upload",ref:_,"custom-request":w,"list-type":"image-card",max:1,"default-upload":!1,onChange:g},null,512)]),_:1}),e($,{span:12,label:"分类",path:"categoryId"},{default:n(()=>[e(ee,{value:t.categoryId,"list-fn":b(S).listBaseInfo,"onUpdate:value":a[1]||(a[1]=h=>t.categoryId=h==null?void 0:h.value)},null,8,["value","list-fn"])]),_:1}),e($,{span:12,label:"商品定价/€",path:"price"},{default:n(()=>[e(te,{value:t.price,"onUpdate:value":a[2]||(a[2]=h=>t.price=h),min:0},null,8,["value"])]),_:1}),e($,{span:12,label:"存储位置",path:"storageAddress"},{default:n(()=>[e(f,{value:t.storageAddress,"onUpdate:value":a[3]||(a[3]=h=>t.storageAddress=h)},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["model"]),e(se,{class:"w-full pt-16px",size:12,justify:"end"},{default:n(()=>[e(ae,{class:"w-72px",type:"primary",onClick:d},{default:n(()=>[x("确定")]),_:1})]),_:1})]),_:1},8,["show"])}}}),$e=[{key:"thumbnail",title:"图片",align:"center",width:"200px",render:l=>A(H,{src:l.thumbnail||""})},{key:"name",title:"名称",align:"center"},{key:"totalCount",title:"数量",align:"center"}],De=E({name:"CategoryDetailDrawer",__name:"index",props:{visible:{type:Boolean},id:{}},emits:["update:visible","succeed"],setup(l,{emit:s}){const p=l,i=U({get(){return p.visible},set(o){s("update:visible",o)}}),m=k({});async function _(){const{data:o}=await S.get(p.id);o&&(m.value=o)}return(o,g)=>{const v=we,y=he,t=xe,u=Q,c=X;return R(),z(c,{show:i.value,"display-directive":"show","default-width":"900",resizable:"",onMaskClick:g[0]||(g[0]=d=>i.value=!1),onAfterEnter:_},{default:n(()=>[e(u,{title:"分类详情","native-scrollbar":!1},{default:n(()=>{var d;return[e(y,{columns:4,"label-placement":"left",class:"text-center mb-12px",bordered:""},{default:n(()=>[e(v,{span:2,label:"分类名称"},{default:n(()=>{var w;return[x(F((w=m.value)==null?void 0:w.name),1)]}),_:1}),e(v,{span:2,label:"商品数量"},{default:n(()=>{var w;return[x(F((w=m.value)==null?void 0:w.productCount),1)]}),_:1})]),_:1}),e(t,{remote:"",columns:b($e),data:((d=m.value)==null?void 0:d.products)??[]},null,8,["columns","data"])]}),_:1})]),_:1},8,["show"])}}}),Ee=E({__name:"index",props:{visible:{type:Boolean}},emits:["update:visible","succeed"],setup(l,{emit:s}){const p=l,i=U({get(){return p.visible},set(y){s("update:visible",y)}}),m=()=>{i.value=!1},_=k(),o=O({}),g={name:I("请输入商品分类名称")};async function v(){var t,u;await((t=_.value)==null?void 0:t.validate());const{error:y}=await S.create(o);y||((u=window.$message)==null||u.success("新增成功!"),m(),s("succeed"))}return(y,t)=>{const u=K,c=Z,d=G,w=J,C=D,r=N,a=W;return R(),z(a,{show:i.value,"onUpdate:show":t[1]||(t[1]=f=>i.value=f),preset:"card",title:"新增商品分类",class:"w-700px"},{default:n(()=>[e(w,{ref_key:"formRef",ref:_,class:"w-80% m-auto","label-placement":"left","label-width":150,model:o,rules:g},{default:n(()=>[e(d,{cols:12,"x-gap":18},{default:n(()=>[e(c,{span:12,label:"商品名称",path:"name"},{default:n(()=>[e(u,{value:o.name,"onUpdate:value":t[0]||(t[0]=f=>o.name=f)},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["model"]),e(r,{class:"w-full pt-16px",size:12,justify:"end"},{default:n(()=>[e(C,{class:"w-72px",type:"primary",onClick:v},{default:n(()=>[x("确定")]),_:1})]),_:1})]),_:1},8,["show"])}}});function Re(l){const s=[];return l.forEach(p=>{s.push({id:p.id,name:p.name,value:p.productCount})}),s}function Ae(l){return{tooltip:{trigger:"item"},legend:{bottom:"1%",left:"center",itemStyle:{borderWidth:0}},series:[{name:"类别数量",type:"pie",radius:["45%","75%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:1},label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:"12"}},labelLine:{show:!1},data:Re(l.items)}]}}const ze=E({name:"CategoryEchart",__name:"CategoryEchart",emits:["click"],setup(l,{expose:s,emit:p}){const i=k({}),{domRef:m}=pe(i,o=>{o.on("click",g=>{p("click",g.data)})});async function _(){const{data:o}=await S.list("",{pageSize:"1000"});o&&(i.value=Ae(o))}return _e(()=>{_()}),s({loadEchartData:_}),(o,g)=>(R(),de("div",{ref_key:"pieRef",ref:m,class:"w-full h-500px"},null,512))}}),Be=E({name:"CategoryDashboardDrawer",__name:"index",props:{visible:{type:Boolean}},emits:["update:visible","succeed"],setup(l,{emit:s}){const p=l,i=U({get(){return p.visible},set(c){s("update:visible",c)}}),m=k(),_=()=>{var c;return(c=m.value)==null?void 0:c.loadEchartData()},{bool:o,setTrue:g}=B(),{bool:v,setTrue:y}=B(),t=k("");function u(c){t.value=c.id,g()}return(c,d)=>{const w=q,C=D,r=Q,a=X;return R(),z(a,{show:i.value,"display-directive":"show","default-width":"900",resizable:"",onMaskClick:d[2]||(d[2]=f=>i.value=!1)},{default:n(()=>[e(r,{title:"商品分类","native-scrollbar":!1},{footer:n(()=>[e(C,{size:"small",type:"primary",onClick:b(y)},{default:n(()=>[e(w,{class:"mr-4px text-20px"}),x(" 新增分类 ")]),_:1},8,["onClick"])]),default:n(()=>[e(ze,{ref_key:"categoryEchart",ref:m,onClick:u},null,512)]),_:1}),e(De,{id:t.value,visible:b(o),"onUpdate:visible":d[0]||(d[0]=f=>M(o)?o.value=f:null)},null,8,["id","visible"]),e(Ee,{visible:b(v),"onUpdate:visible":d[1]||(d[1]=f=>M(v)?v.value=f:null),onSucceed:_},null,8,["visible"])]),_:1},8,["show"])}}}),Me=[{key:"images",title:"图片",align:"center",width:"200px",render:l=>A(H,{src:l.thumbnail||""})},{key:"name",title:"名称",align:"center"},{key:"category",title:"分类",align:"center",render:l=>A(P,{},{default:()=>{var s;return`${(s=l.category)==null?void 0:s.name}`}})},{key:"totalCount",title:"数量",align:"center"},{key:"price",title:"售价",align:"center",render:l=>A(P,{},{default:()=>`€${l.price}`})},{key:"storageAddress",title:"存放位置",align:"center"},{key:"status",title:"状态",align:"center",render:l=>{const s=ue[l.status||"1"];return A(ke,{type:s.type},{default:()=>s.label})}}],mt=E({__name:"index",setup(l){const{bool:s,setTrue:p}=B(),{bool:i,setTrue:m}=B(),_=k(),o=()=>L.exportProductExcel(),g=()=>{var u;return(u=_.value)==null?void 0:u.loadTableData()},v=[{key:"actions",title:"操作",align:"center",render:u=>e(N,{justify:"center"},{default:()=>[e(D,{size:"small",onClick:()=>t(u.id)},{default:()=>[x("详情")]})]})}],{routerPush:y}=me();function t(u){y({name:fe("warehouse_product-detail"),query:{id:u}})}return(u,c)=>{const d=ce,w=q,C=re,r=be;return R(),z(r,{bordered:!1,class:"h-full rounded-16px shadow-sm"},{default:n(()=>[e(ge,{ref_key:"listTable",ref:_,columns:b(Me),"action-columns":v,"load-data":b(L).list},{default:n(()=>[e(b(D),{size:"small",type:"primary",onClick:b(m)},{default:n(()=>[e(d,{class:"mr-4px text-20px"}),x(" 商品分类 ")]),_:1},8,["onClick"]),e(b(D),{size:"small",type:"primary",onClick:b(p)},{default:n(()=>[e(w,{class:"mr-4px text-20px"}),x(" 新增商品 ")]),_:1},8,["onClick"]),e(b(D),{size:"small",type:"success",onClick:o},{default:n(()=>[e(C,{class:"mr-4px text-20px"}),x(" 导出Excel ")]),_:1})]),_:1},8,["columns","load-data"]),e(Ce,{visible:b(s),"onUpdate:visible":c[0]||(c[0]=a=>M(s)?s.value=a:null),onSucceed:g},null,8,["visible"]),e(Be,{visible:b(i),"onUpdate:visible":c[1]||(c[1]=a=>M(i)?i.value=a:null)},null,8,["visible"])]),_:1})}}});export{mt as default};
